# 1. **이미지 형태 변환하기**

이번 실습에서는 이미지의 형태를 변환하는 기법들을 Pillow를 통해 구현해보도록 하겠습니다.

대표적인 이미지 변형 기법에는 잘라내기(Crop), 회전(Rotate), 크기 변화(Resize), 전단 변환(Shearing) 등이 있습니다.

지시사항에 따라 각각의 기능을 구현해보세요.

## 지시사항

1. 이미지를 잘라내는 함수

    

   ```
   crop
   ```

   을 완성하세요.

   - 이미지를 잘라낼 좌표는 `coordinates` 파라미터에 지정되어 있습니다.

1. 이미지를 회전하는 함수

    

   ```
   rotate
   ```

   를 완성하세요.

   - `angle`은 이미지를 반시계 방향으로 회전할 각도입니다.
   - `expand`는 회전 결과를 기존 이미지 사이즈 내에서 표현할지 여부를 결정하는 파라미터입니다.

1. 이미지의 사이즈를 변경하는 함수

    

   ```
   resize
   ```

   를 완성하세요.

   - `new_size`는 새로운 이미지 사이즈입니다.

1. 이미지에 전단 변환(Shearing)을 적용하는 함수

    

   ```
   shearing
   ```

   을 완성하세요.

   - `shear_factor`는 전단 변환을 적용할 정도, 즉 평행사변형을 얼마나 기울일지를 결정하는 파라미터입니다.
   - 세개의 `None`에 `img`에 사용할 메소드, 사용할 변환 이름, 적절한 `shear_factor` 값을 넣어주면 됩니다.

1. ```
   main
   ```

    

   함수에서 불러온 이미지

    

   ```
   img
   ```

   에 아래 작업을 수행하도록 하세요.

   - 좌측 상단 좌표는 (150,200)(150,200), 우측 하단 좌표는 (450,300)(450,300)으로 하여 이미지를 잘라내세요.
   - 이미지를 반시계 방향으로 160도만큼 회전시키고, 회전한 이미지를 모두 표현할 수 있도록 하세요.
   - 이미지 크기를 (640,360)(640,360)으로 변경하세요.
   - 전단 변환 정도를 0.8로 하여 전단 변환을 수행하세요.



# 2. **이미지 색상 변환하기**

이번 실습에서는 이미지의 색상을 변환하는 기법들을 Pillow를 통해 구현해보도록 하겠습니다.

대표적인 이미지 색상 변환 기법에는 밝기 변환, 대조 변환, 흑백 변환 등이 있습니다.

지시사항에 따라 각각의 기능을 구현해보세요.

## 지시사항

### 1. 밝기 변화

이미지의 밝기를 변화시키는 함수 `change_brightness`을 완성하세요.
\- `factor`는 밝기가 변화할 정도입니다.
\- 밝기 변환을 수행할 Enhancer 객체를 만들어야 합니다.

### 2. 대조 변화

이미지의 대조를 변화시키는 함수 `change_contrast`을 완성하세요.
\- `factor`는 대조가 변화할 정도입니다.
\- 대조 변환을 수행할 Enhancer 객체를 만들어야 합니다.

### 3. 이미지 변환

1. ```
   main
   ```

    

   함수에서 불러온 이미지

    

   ```
   img
   ```

   에 아래 작업을 수행하도록 하세요.

   - 이미지를 **1.5배 밝게** 하세요.
   - 이미지를 **5배 어둡게 (0.2배 밝게)** 하세요.
   - 이미지의 **대조를 3배 강하게** 만드세요.
   - 이미지의 **대조를 10배 약하게** (0.1배로) 만드세요.



# 3. CNN을 활용한 Fashion-MNIST 분류 모델 구현

이번 실습에서는 초기 CNN 계열 모델인 LeNet-5 모델을 활용해서 Fashion-MNIST 분류 모델을 구현하고 모델을 학습시켜 볼 것입니다.

아래 지시사항과 보조 자료의 안내를 따라 코드를 완성하세요.

## 지시사항

### 1. 데이터 전처리 (20점)

보조 자료 영상을 참고하여, 이미지 데이터의 크기를 LeNet-5의 입력 크기에 맞게 32x32 픽셀 크기로 변환하는 코드를 완성해주세요.

- MLP 모델과 달리, 일렬로 나열된 픽셀로 변환하지 않습니다.

### 2. 모델 정의 (40점)

보조 자료 영상을 참고하여, LeNet-5 모델을 정의해주세요. 세부 사항은 노트북 파일에서 확인하실 수 있습니다.

### 3. 모델 학습 (20점)

보조 자료 영상을 참고하여, None을 지시사항의 조건을 만족하도록 모델을 학습시키는 코드로 대체해주세요.

- epochs는 10으로 설정합니다.
- batch_size는 32로 설정합니다.
- 학습 데이터로 `train_images`와 `train_labels`를 사용합니다.
- 검증 데이터로 `val_images`와 `val_labels` 를 사용합니다.

### 4. 모델 평가 (20점)

보조 자료 영상을 참고하여 테스트 데이터에 대해 모델을 평가하고, loss값을 `test_loss` 변수에, 테스트 정확도 값을 `test_acc` 변수에 저장해주세요. 두 값이 특정 기준을 만족하면 점수가 부여됩니다.



# 4. CNN 기반 개와 고양이 이미지 데이터 분류 모델 구현

이번 실습에서는 3장에서 배운 지식을 활용하여 CNN 기반 개와 고양이 이미지 데이터 분류 모델을 구현하고 고도화 해볼 것입니다.

아래 지시사항과 보조 자료의 안내를 따라 코드를 완성하세요.

## 지시사항

### 1. TensorFlow Dataset 구성 (10점)

keras.utils.image_dataset_from_directory 함수를 활용해 저장된 이미지 파일로부터 tensorflow Dataset을 생성합니다.

### 2-1. 데이터 전처리 (10점)

데이터를 불러오면서 이미지의 size를 (image_size, image_size) 로 일괄적으로 조정했습니다. 여기에 더해, RGB 픽셀 값을 [0,1] 값으로 Rescaling 하겠습니다.

Keras의 Rescaling 레이어를 모델의 첫번째 레이어로 추가해주세요.

### 2-2. 데이터 증강 (10점)

데이터를 전처리 하는 것 뿐만 아니라, 모델의 일반화 성능을 향상시키기 위해 데이터 증강을 적용할 수 있습니다.

Keras의 RandomFlip, RandomRotation 레이어를 모델에 추가해주세요. 이때, RandomFlip은 인자로 “horizontal”을 사용해서 수평 반전만 적용하도록 하고, RandomRotation은 인자로 0.1을 입력해서 [−0.1×2π−0.1×2*π*, 0.1×2π0.1×2*π*] 범위 내에서 랜덤하게 회전되도록 적용해주세요.

### 3. 모델 정의 (20점)

아래 조건을 만족하는 Dogs vs Cats CNN 분류 모델을 정의합니다.

#### A. Convolutional Layers

- CNN 레이어는 총 3개 사용하며, 순서대로 32, 64, 128개의 필터를 사용합니다.
- 모든 CNN 레이어의 필터 크기는 (3,3) 입니다.
- 모든 CNN 레이어의 활성화 함수는 `relu` 입니다.
- 각 CNN 레이어 뒤에 (2,2) 크기의 MaxPooling2D 레이어를 추가합니다.

#### B. Fully-connected Layers

- Convolutional Layers의 최종 출력값을 입력받을 수 있도록 Flatten() 레이어를 처음에 추가합니다.
- Dense Layer는 총 2개 사용합니다.
- 은닉층의 차원은 512이며, `relu` 활성화 함수를 사용합니다.
- 출력층의 차원은 1이며, `sigmoid` 활성화 함수를 사용합니다.
- 두 은닉층 사이에 Dropout Layer를 추가합니다. (Dropout 확률은 50%로 설정합니다.)

### 4. 모델 학습 (20점)

보조 자료 영상을 참고하여, None을 지시사항의 조건을 만족하도록 모델을 학습시키는 코드로 대체해주세요.

- epochs는 30으로 설정합니다.
- 학습 데이터로는 `train_dataset`을 사용합니다.
- 검증 데이터로는 `val_dataset`을 사용합니다.
- 미리 정의된 `callbacks` 배열을 콜백 함수로 등록합니다.

### 5. 모델 평가 (30점)

이번 실습에서는 모델 평가를 코드 내부에서 하지 않고, 여러분의 모델이 예측한 결과를 바탕으로 시스템에서 평가합니다.

모델의 테스트 정확도가 65%를 넘으면 성공입니다.

아래 두 코드 블럭을 실행해서 모델의 예측 결과 및 다른 문제에 대한 답변을 저장하고, 우측 상단의 제출 버튼을 눌러서 결과를 확인해주세요.